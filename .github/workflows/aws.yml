name: Deploy to Amazon EC2

on:
  push:
    branches: [ "develop" ]

env:
  AWS_REGION: eu-central-1

jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    environment: development

    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: build
      uses: burnett01/rsync-deployments@5.1
      with:
        switches: -avzr --delete
        remote-path: /home/ubuntu/code
        remote_host: ec2-3-68-94-147.eu-central-1.compute.amazonaws.com
        remote_user: ubuntu
        remote_key: "${{ secrets.AWS_SSH }}"
    # - name: Configure AWS credentials
    #   uses: aws-actions/configure-aws-credentials@v1
    #   with:
    #     aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
    #     aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    #     aws-region: ${{ env.AWS_REGION }}